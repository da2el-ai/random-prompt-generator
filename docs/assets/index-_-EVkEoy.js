(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}})();class k{container;groupNumber;tagsTextarea;minCountSelect;maxCountSelect;minWeightInput;maxWeightInput;changeCallback;constructor(e,t){this.groupNumber=e,this.changeCallback=t,this.container=this.createTagGroup()}createTagGroup(){const e=document.createElement("details");e.className="mb-4 border border-gray-300 rounded-lg overflow-hidden",e.open=!0;const t=document.createElement("summary");t.className="bg-gray-50 px-4 py-3 cursor-pointer hover:bg-gray-100 font-medium text-gray-700",t.textContent=`タググループ${this.groupNumber}`;const r=document.createElement("div");r.className="p-4 bg-white grid grid-cols-1 md:grid-cols-2 gap-4";const a=document.createElement("div");a.innerHTML=`
      <label class="block text-sm font-medium text-gray-700 mb-2">タグ候補</label>
      <p class="text-xs text-gray-500 mb-1">改行区切りで1行＝1タグ</p>
    `,this.tagsTextarea=document.createElement("textarea"),this.tagsTextarea.className="w-full h-32 p-3 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.tagsTextarea.placeholder=`1girl
cute
beautiful
portrait
...`,this.tagsTextarea.addEventListener("input",()=>this.onInputChange()),a.appendChild(this.tagsTextarea);const n=document.createElement("div");n.className="space-y-4";const s=document.createElement("div");s.className="grid grid-cols-2 gap-4";const c=document.createElement("div");c.innerHTML='<label class="block text-sm font-medium text-gray-700 mb-1">最小個数</label>',this.minCountSelect=document.createElement("select"),this.minCountSelect.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.minCountSelect.innerHTML=this.generateOptions(0,10,this.groupNumber===1?1:0),this.minCountSelect.addEventListener("change",()=>this.onInputChange()),c.appendChild(this.minCountSelect);const p=document.createElement("div");p.innerHTML='<label class="block text-sm font-medium text-gray-700 mb-1">最大個数</label>',this.maxCountSelect=document.createElement("select"),this.maxCountSelect.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.maxCountSelect.innerHTML=this.generateOptions(1,10,3),this.maxCountSelect.addEventListener("change",()=>this.onInputChange()),p.appendChild(this.maxCountSelect),s.appendChild(c),s.appendChild(p);const i=document.createElement("div");i.className="grid grid-cols-2 gap-4";const l=document.createElement("div");l.innerHTML='<label class="block text-sm font-medium text-gray-700 mb-1">最小重み</label>',this.minWeightInput=document.createElement("input"),this.minWeightInput.type="number",this.minWeightInput.step="0.1",this.minWeightInput.value="0.5",this.minWeightInput.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.minWeightInput.addEventListener("input",()=>this.onInputChange()),l.appendChild(this.minWeightInput);const u=document.createElement("div");return u.innerHTML='<label class="block text-sm font-medium text-gray-700 mb-1">最大重み</label>',this.maxWeightInput=document.createElement("input"),this.maxWeightInput.type="number",this.maxWeightInput.step="0.1",this.maxWeightInput.value="1.3",this.maxWeightInput.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.maxWeightInput.addEventListener("input",()=>this.onInputChange()),u.appendChild(this.maxWeightInput),i.appendChild(l),i.appendChild(u),n.appendChild(s),n.appendChild(i),r.appendChild(a),r.appendChild(n),e.appendChild(t),e.appendChild(r),e}generateOptions(e,t,r){let a="";for(let n=e;n<=t;n++)a+=`<option value="${n}" ${n===r?"selected":""}>${n}</option>`;return a}getElement(){return this.container}onInputChange(){this.changeCallback&&this.changeCallback()}getTagGroupData(){return{tags:this.tagsTextarea.value.split(`
`).filter(e=>e.trim().length>0),minCount:parseInt(this.minCountSelect.value),maxCount:parseInt(this.maxCountSelect.value),minWeight:parseFloat(this.minWeightInput.value),maxWeight:parseFloat(this.maxWeightInput.value)}}setTagGroupData(e){e.tags&&Array.isArray(e.tags)&&(this.tagsTextarea.value=e.tags.join(`
`)),typeof e.minCount=="number"&&(this.minCountSelect.value=e.minCount.toString()),typeof e.maxCount=="number"&&(this.maxCountSelect.value=e.maxCount.toString()),typeof e.minWeight=="number"&&(this.minWeightInput.value=e.minWeight.toString()),typeof e.maxWeight=="number"&&(this.maxWeightInput.value=e.maxWeight.toString())}}class T{container;resultTextarea;outputCountInput;escapeParenthesesCheckbox;spaceConversionSelect;artistPrefixCheckbox;insertBlankLinesCheckbox;addTrailingCommaCheckbox;generateButton;copyButton;clearButton;generateCallback;constructor(e){this.generateCallback=e,this.container=this.createGenerationGroup()}createGenerationGroup(){const e=document.createElement("section");e.className="mb-6 border border-gray-300 rounded-lg overflow-hidden bg-white";const t=document.createElement("div");t.className="p-4 grid grid-cols-1 lg:grid-cols-2 gap-4";const r=document.createElement("div"),a=document.createElement("label");a.className="block text-sm font-medium text-gray-700 mb-2",a.textContent="生成結果",this.resultTextarea=document.createElement("textarea"),this.resultTextarea.className="w-full h-48 p-3 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-green-500 focus:border-green-500",this.resultTextarea.placeholder="生成されたプロンプトがここに表示されます...",this.resultTextarea.readOnly=!0,this.generateButton=document.createElement("button"),this.generateButton.className="w-full px-4 py-3 bg-green-500 text-white rounded-md hover:bg-green-600 focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors font-medium",this.generateButton.textContent="プロンプト生成",this.generateButton.addEventListener("click",()=>this.onGenerateClick()),this.copyButton=document.createElement("button"),this.copyButton.className="mt-2 mr-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",this.copyButton.textContent="生成結果をコピー",this.copyButton.addEventListener("click",()=>this.copyToClipboard()),this.clearButton=document.createElement("button"),this.clearButton.className="mt-2 px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors",this.clearButton.textContent="生成結果を消去",this.clearButton.addEventListener("click",()=>this.clearResult());const n=document.createElement("div");n.appendChild(this.copyButton),n.appendChild(this.clearButton),r.appendChild(a),r.appendChild(this.resultTextarea),r.appendChild(this.generateButton),r.appendChild(n);const s=document.createElement("div");s.className="space-y-4";const c=document.createElement("div"),p=document.createElement("label");p.className="block text-sm font-medium text-gray-700 mb-1",p.textContent="出力数",this.outputCountInput=document.createElement("input"),this.outputCountInput.type="number",this.outputCountInput.value="5",this.outputCountInput.min="1",this.outputCountInput.max="20",this.outputCountInput.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",c.appendChild(p),c.appendChild(this.outputCountInput);const i=document.createElement("div");i.className="space-y-3";const l=document.createElement("div");l.className="flex items-center",this.escapeParenthesesCheckbox=document.createElement("input"),this.escapeParenthesesCheckbox.type="checkbox",this.escapeParenthesesCheckbox.id="escape-parentheses",this.escapeParenthesesCheckbox.className="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded";const u=document.createElement("label");u.htmlFor="escape-parentheses",u.className="ml-2 text-sm text-gray-700",u.innerHTML="<code>()</code>を<code>\\(\\)</code>に変換",l.appendChild(this.escapeParenthesesCheckbox),l.appendChild(u);const d=document.createElement("div");d.className="flex flex-col";const x=document.createElement("label");x.className="block text-sm font-medium text-gray-700 mb-1",x.textContent="空白変換",this.spaceConversionSelect=document.createElement("select"),this.spaceConversionSelect.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",this.spaceConversionSelect.innerHTML=`
      <option value="none">変換しない</option>
      <option value="space-to-underscore">空白を_に変換</option>
      <option value="underscore-to-space">_を空白に変換</option>
    `,d.appendChild(x),d.appendChild(this.spaceConversionSelect);const h=document.createElement("div");h.className="flex items-center",this.artistPrefixCheckbox=document.createElement("input"),this.artistPrefixCheckbox.type="checkbox",this.artistPrefixCheckbox.id="artist-prefix",this.artistPrefixCheckbox.className="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded";const m=document.createElement("label");m.htmlFor="artist-prefix",m.className="ml-2 text-sm text-gray-700",m.innerHTML="タグの先頭に<code>artist:</code>を付与",h.appendChild(this.artistPrefixCheckbox),h.appendChild(m);const g=document.createElement("div");g.className="flex items-center",this.insertBlankLinesCheckbox=document.createElement("input"),this.insertBlankLinesCheckbox.type="checkbox",this.insertBlankLinesCheckbox.id="insert-blank-lines",this.insertBlankLinesCheckbox.className="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded",this.insertBlankLinesCheckbox.checked=!0;const b=document.createElement("label");b.htmlFor="insert-blank-lines",b.className="ml-2 text-sm text-gray-700",b.textContent="生成結果に空行を挿入",g.appendChild(this.insertBlankLinesCheckbox),g.appendChild(b);const C=document.createElement("div");C.className="flex items-center",this.addTrailingCommaCheckbox=document.createElement("input"),this.addTrailingCommaCheckbox.type="checkbox",this.addTrailingCommaCheckbox.id="add-trailing-comma",this.addTrailingCommaCheckbox.className="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded";const f=document.createElement("label");return f.htmlFor="add-trailing-comma",f.className="ml-2 text-sm text-gray-700",f.innerHTML="末尾に<code>,</code>を追加",C.appendChild(this.addTrailingCommaCheckbox),C.appendChild(f),i.appendChild(d),i.appendChild(l),i.appendChild(h),i.appendChild(g),i.appendChild(C),s.appendChild(c),s.appendChild(i),t.appendChild(r),t.appendChild(s),e.appendChild(t),e}getElement(){return this.container}onGenerateClick(){this.generateCallback&&this.generateCallback()}async copyToClipboard(){try{await navigator.clipboard.writeText(this.resultTextarea.value);const e=this.copyButton.textContent;this.copyButton.textContent="コピーしました！",this.copyButton.className=this.copyButton.className.replace("bg-blue-500 hover:bg-blue-600","bg-green-500 hover:bg-green-600"),setTimeout(()=>{this.copyButton.textContent=e,this.copyButton.className=this.copyButton.className.replace("bg-green-500 hover:bg-green-600","bg-blue-500 hover:bg-blue-600")},2e3)}catch(e){console.error("クリップボードへのコピーに失敗しました:",e),alert("クリップボードへのコピーに失敗しました")}}clearResult(){this.resultTextarea.value=""}getGenerationOptions(){return{outputCount:parseInt(this.outputCountInput.value)||5,escapeParentheses:this.escapeParenthesesCheckbox.checked,spaceConversion:this.spaceConversionSelect.value,addArtistPrefix:this.artistPrefixCheckbox.checked,insertBlankLines:this.insertBlankLinesCheckbox.checked,addTrailingComma:this.addTrailingCommaCheckbox.checked}}setGenerationOptions(e){typeof e.outputCount=="number"&&(this.outputCountInput.value=e.outputCount.toString()),typeof e.escapeParentheses=="boolean"&&(this.escapeParenthesesCheckbox.checked=e.escapeParentheses),typeof e.spaceConversion=="string"&&(this.spaceConversionSelect.value=e.spaceConversion),typeof e.addArtistPrefix=="boolean"&&(this.artistPrefixCheckbox.checked=e.addArtistPrefix),typeof e.insertBlankLines=="boolean"&&(this.insertBlankLinesCheckbox.checked=e.insertBlankLines),typeof e.addTrailingComma=="boolean"&&(this.addTrailingCommaCheckbox.checked=e.addTrailingComma)}setResult(e){this.getGenerationOptions().insertBlankLines?this.resultTextarea.value=e.join(`

`):this.resultTextarea.value=e.join(`
`)}}function S(o,e){return e===1?o:`(${o}:${e.toFixed(1)})`}function E(o,e){let t=o;return e.addArtistPrefix&&(t=`artist:${t}`),e.spaceConversion==="space-to-underscore"?t=t.replace(/\s+/g,"_"):e.spaceConversion==="underscore-to-space"&&(t=t.replace(/_/g," ")),e.escapeParentheses&&(t=t.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),t}function G(o,e){return Math.random()*(e-o)+o}function L(o,e){return Math.floor(Math.random()*(e-o+1))+o}function N(o,e){return[...o].sort(()=>.5-Math.random()).slice(0,e)}class I{static generateSinglePrompt(e,t){const r=[];for(const n of e){const s=this.parseTagsFromText(n.tags);if(s.length===0)continue;const c=L(n.minCount,n.maxCount);if(c===0)continue;const p=N(s,c);for(const i of p){const l=E(i.trim(),t),u=G(n.minWeight,n.maxWeight),d=S(l,u);r.push(d)}}let a=r.join(", ");return t.addTrailingComma&&(a+=","),a}static generatePrompts(e,t){const r=[];for(let a=0;a<t.outputCount;a++){const n=this.generateSinglePrompt(e,t);r.push(n)}return r}static parseTagsFromText(e){return Array.isArray(e)?e:e.split(`
`).map(r=>r.trim()).filter(r=>r.length>0)}}const v="random-prompt-generator-state";function P(){try{const o=localStorage.getItem(v);return o?JSON.parse(o):null}catch(o){return console.warn("LocalStorageからの読み込みに失敗しました:",o),null}}function B(o){try{localStorage.setItem(v,JSON.stringify(o))}catch(e){console.warn("LocalStorageへの保存に失敗しました:",e)}}function W(){const o=(t=0)=>({tags:[],minCount:t,maxCount:3,minWeight:.5,maxWeight:1.3}),e={outputCount:5,escapeParentheses:!1,spaceConversion:"none",addArtistPrefix:!1,insertBlankLines:!0,addTrailingComma:!1};return{tagGroup1:o(1),tagGroup2:o(0),tagGroup3:o(0),generationOptions:e,generatedPrompts:[]}}class w{container;tagGroups=[];generationGroup;appState;constructor(e){this.container=e,this.appState=P()||W(),this.generationGroup=new T(()=>this.generatePrompts()),this.init()}init(){this.container.innerHTML="";const e=document.createElement("header");e.className="text-center mb-8",e.innerHTML=`
      <h1 class="text-4xl font-bold text-gray-800 mb-2">Random Prompt Generator</h1>
      <p class="text-gray-600">画像生成AI用プロンプトをランダム生成</p>
    `;const t=document.createElement("main");t.className="space-y-6";for(let a=1;a<=3;a++){const n=new k(a,()=>this.saveState());this.tagGroups.push(n),t.appendChild(n.getElement())}t.appendChild(this.generationGroup.getElement());const r=document.createElement("footer");r.className="text-center mt-12 pt-8 border-t border-gray-200",r.innerHTML=`
      <p class="text-gray-500 text-sm">
        設定は自動的にLocalStorageに保存されます
      </p>
    `,this.container.appendChild(e),this.container.appendChild(t),this.container.appendChild(r),this.loadState()}generatePrompts(){try{const e=[this.tagGroups[0].getTagGroupData(),this.tagGroups[1].getTagGroupData(),this.tagGroups[2].getTagGroupData()],t=this.generationGroup.getGenerationOptions(),r=I.generatePrompts(e,t);this.generationGroup.setResult(r),this.appState.generatedPrompts=r,this.saveState(),console.log("プロンプト生成完了:",r)}catch(e){console.error("プロンプト生成中にエラーが発生しました:",e),alert("プロンプト生成中にエラーが発生しました")}}saveState(){this.appState.tagGroup1=this.tagGroups[0].getTagGroupData(),this.appState.tagGroup2=this.tagGroups[1].getTagGroupData(),this.appState.tagGroup3=this.tagGroups[2].getTagGroupData(),this.appState.generationOptions=this.generationGroup.getGenerationOptions(),B(this.appState)}loadState(){this.tagGroups[0].setTagGroupData(this.appState.tagGroup1),this.tagGroups[1].setTagGroupData(this.appState.tagGroup2),this.tagGroups[2].setTagGroupData(this.appState.tagGroup3),this.generationGroup.setGenerationOptions(this.appState.generationOptions),this.appState.generatedPrompts.length>0&&this.generationGroup.setResult(this.appState.generatedPrompts)}}const y=document.createElement("div");y.className="min-h-screen bg-gray-100 p-4";y.innerHTML=`
  <div class="max-w-6xl mx-auto" id="app-content">
    <!-- アプリケーションのコンテンツがここに追加されます -->
  </div>
`;document.querySelector("#app").appendChild(y);const D=document.querySelector("#app-content");new w(D);console.log("Random Prompt Generator UI が起動しました");
