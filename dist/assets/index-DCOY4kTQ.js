(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();class y{container;groupNumber;tagsTextarea;minCountSelect;maxCountSelect;minWeightInput;maxWeightInput;changeCallback;constructor(e,t){this.groupNumber=e,this.changeCallback=t,this.container=this.createTagGroup()}createTagGroup(){const e=document.createElement("details");e.className="mb-4 border border-gray-300 rounded-lg overflow-hidden",e.open=!0;const t=document.createElement("summary");t.className="bg-gray-50 px-4 py-3 cursor-pointer hover:bg-gray-100 font-medium text-gray-700",t.textContent=`タググループ${this.groupNumber}`;const r=document.createElement("div");r.className="p-4 bg-white grid grid-cols-1 md:grid-cols-2 gap-4";const n=document.createElement("div");n.innerHTML=`
      <label class="block text-sm font-medium text-gray-700 mb-2">タグ候補</label>
      <p class="text-xs text-gray-500 mb-1">改行区切りで1行＝1タグ</p>
    `,this.tagsTextarea=document.createElement("textarea"),this.tagsTextarea.className="w-full h-32 p-3 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.tagsTextarea.placeholder=`1girl
cute
beautiful
portrait
...`,this.tagsTextarea.addEventListener("input",()=>this.onInputChange()),n.appendChild(this.tagsTextarea);const a=document.createElement("div");a.className="space-y-4";const o=document.createElement("div");o.className="grid grid-cols-2 gap-4";const u=document.createElement("div");u.innerHTML='<label class="block text-sm font-medium text-gray-700 mb-1">最小個数</label>',this.minCountSelect=document.createElement("select"),this.minCountSelect.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.minCountSelect.innerHTML=this.generateOptions(0,10,this.groupNumber===1?1:0),this.minCountSelect.addEventListener("change",()=>this.onInputChange()),u.appendChild(this.minCountSelect);const p=document.createElement("div");p.innerHTML='<label class="block text-sm font-medium text-gray-700 mb-1">最大個数</label>',this.maxCountSelect=document.createElement("select"),this.maxCountSelect.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.maxCountSelect.innerHTML=this.generateOptions(1,10,3),this.maxCountSelect.addEventListener("change",()=>this.onInputChange()),p.appendChild(this.maxCountSelect),o.appendChild(u),o.appendChild(p);const i=document.createElement("div");i.className="grid grid-cols-2 gap-4";const c=document.createElement("div");c.innerHTML='<label class="block text-sm font-medium text-gray-700 mb-1">最小重み</label>',this.minWeightInput=document.createElement("input"),this.minWeightInput.type="number",this.minWeightInput.step="0.1",this.minWeightInput.value="0.5",this.minWeightInput.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.minWeightInput.addEventListener("input",()=>this.onInputChange()),c.appendChild(this.minWeightInput);const l=document.createElement("div");return l.innerHTML='<label class="block text-sm font-medium text-gray-700 mb-1">最大重み</label>',this.maxWeightInput=document.createElement("input"),this.maxWeightInput.type="number",this.maxWeightInput.step="0.1",this.maxWeightInput.value="1.3",this.maxWeightInput.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",this.maxWeightInput.addEventListener("input",()=>this.onInputChange()),l.appendChild(this.maxWeightInput),i.appendChild(c),i.appendChild(l),a.appendChild(o),a.appendChild(i),r.appendChild(n),r.appendChild(a),e.appendChild(t),e.appendChild(r),e}generateOptions(e,t,r){let n="";for(let a=e;a<=t;a++)n+=`<option value="${a}" ${a===r?"selected":""}>${a}</option>`;return n}getElement(){return this.container}onInputChange(){this.changeCallback&&this.changeCallback()}getTagGroupData(){return{tags:this.tagsTextarea.value.split(`
`).filter(e=>e.trim().length>0),minCount:parseInt(this.minCountSelect.value),maxCount:parseInt(this.maxCountSelect.value),minWeight:parseFloat(this.minWeightInput.value),maxWeight:parseFloat(this.maxWeightInput.value)}}setTagGroupData(e){e.tags&&Array.isArray(e.tags)&&(this.tagsTextarea.value=e.tags.join(`
`)),typeof e.minCount=="number"&&(this.minCountSelect.value=e.minCount.toString()),typeof e.maxCount=="number"&&(this.maxCountSelect.value=e.maxCount.toString()),typeof e.minWeight=="number"&&(this.minWeightInput.value=e.minWeight.toString()),typeof e.maxWeight=="number"&&(this.maxWeightInput.value=e.maxWeight.toString())}}class k{container;resultTextarea;outputCountInput;escapeParenthesesCheckbox;replaceSpacesCheckbox;artistPrefixCheckbox;insertBlankLinesCheckbox;generateButton;copyButton;clearButton;generateCallback;constructor(e){this.generateCallback=e,this.container=this.createGenerationGroup()}createGenerationGroup(){const e=document.createElement("section");e.className="mb-6 border border-gray-300 rounded-lg overflow-hidden bg-white";const t=document.createElement("div");t.className="p-4 grid grid-cols-1 lg:grid-cols-2 gap-4";const r=document.createElement("div"),n=document.createElement("label");n.className="block text-sm font-medium text-gray-700 mb-2",n.textContent="生成結果",this.resultTextarea=document.createElement("textarea"),this.resultTextarea.className="w-full h-48 p-3 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-green-500 focus:border-green-500",this.resultTextarea.placeholder="生成されたプロンプトがここに表示されます...",this.resultTextarea.readOnly=!0,this.copyButton=document.createElement("button"),this.copyButton.className="mt-2 mr-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",this.copyButton.textContent="生成結果をコピー",this.copyButton.addEventListener("click",()=>this.copyToClipboard()),this.clearButton=document.createElement("button"),this.clearButton.className="mt-2 px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors",this.clearButton.textContent="生成結果を消去",this.clearButton.addEventListener("click",()=>this.clearResult());const a=document.createElement("div");a.appendChild(this.copyButton),a.appendChild(this.clearButton),r.appendChild(n),r.appendChild(this.resultTextarea),r.appendChild(a);const o=document.createElement("div");o.className="space-y-4";const u=document.createElement("div"),p=document.createElement("label");p.className="block text-sm font-medium text-gray-700 mb-1",p.textContent="出力数",this.outputCountInput=document.createElement("input"),this.outputCountInput.type="number",this.outputCountInput.value="5",this.outputCountInput.min="1",this.outputCountInput.max="20",this.outputCountInput.className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",u.appendChild(p),u.appendChild(this.outputCountInput);const i=document.createElement("div");i.className="space-y-3";const c=document.createElement("div");c.className="flex items-center",this.escapeParenthesesCheckbox=document.createElement("input"),this.escapeParenthesesCheckbox.type="checkbox",this.escapeParenthesesCheckbox.id="escape-parentheses",this.escapeParenthesesCheckbox.className="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded";const l=document.createElement("label");l.htmlFor="escape-parentheses",l.className="ml-2 text-sm text-gray-700",l.innerHTML="<code>()</code>を<code>\\(\\)</code>に変換",c.appendChild(this.escapeParenthesesCheckbox),c.appendChild(l);const h=document.createElement("div");h.className="flex items-center",this.replaceSpacesCheckbox=document.createElement("input"),this.replaceSpacesCheckbox.type="checkbox",this.replaceSpacesCheckbox.id="replace-spaces",this.replaceSpacesCheckbox.className="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded";const d=document.createElement("label");d.htmlFor="replace-spaces",d.className="ml-2 text-sm text-gray-700",d.innerHTML="空白を<code>_</code>に変換",h.appendChild(this.replaceSpacesCheckbox),h.appendChild(d);const m=document.createElement("div");m.className="flex items-center",this.artistPrefixCheckbox=document.createElement("input"),this.artistPrefixCheckbox.type="checkbox",this.artistPrefixCheckbox.id="artist-prefix",this.artistPrefixCheckbox.className="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded";const g=document.createElement("label");g.htmlFor="artist-prefix",g.className="ml-2 text-sm text-gray-700",g.innerHTML="タグの先頭に<code>artist:</code>を付与",m.appendChild(this.artistPrefixCheckbox),m.appendChild(g);const b=document.createElement("div");b.className="flex items-center",this.insertBlankLinesCheckbox=document.createElement("input"),this.insertBlankLinesCheckbox.type="checkbox",this.insertBlankLinesCheckbox.id="insert-blank-lines",this.insertBlankLinesCheckbox.className="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded",this.insertBlankLinesCheckbox.checked=!0;const f=document.createElement("label");return f.htmlFor="insert-blank-lines",f.className="ml-2 text-sm text-gray-700",f.textContent="生成結果に空行を挿入",b.appendChild(this.insertBlankLinesCheckbox),b.appendChild(f),i.appendChild(c),i.appendChild(h),i.appendChild(m),i.appendChild(b),this.generateButton=document.createElement("button"),this.generateButton.className="w-full px-4 py-3 bg-green-500 text-white rounded-md hover:bg-green-600 focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors font-medium",this.generateButton.textContent="プロンプト生成",this.generateButton.addEventListener("click",()=>this.onGenerateClick()),o.appendChild(u),o.appendChild(i),o.appendChild(this.generateButton),t.appendChild(r),t.appendChild(o),e.appendChild(t),e}getElement(){return this.container}onGenerateClick(){this.generateCallback&&this.generateCallback()}async copyToClipboard(){try{await navigator.clipboard.writeText(this.resultTextarea.value);const e=this.copyButton.textContent;this.copyButton.textContent="コピーしました！",this.copyButton.className=this.copyButton.className.replace("bg-blue-500 hover:bg-blue-600","bg-green-500 hover:bg-green-600"),setTimeout(()=>{this.copyButton.textContent=e,this.copyButton.className=this.copyButton.className.replace("bg-green-500 hover:bg-green-600","bg-blue-500 hover:bg-blue-600")},2e3)}catch(e){console.error("クリップボードへのコピーに失敗しました:",e),alert("クリップボードへのコピーに失敗しました")}}clearResult(){this.resultTextarea.value=""}getGenerationOptions(){return{outputCount:parseInt(this.outputCountInput.value)||5,escapeParentheses:this.escapeParenthesesCheckbox.checked,replaceSpaces:this.replaceSpacesCheckbox.checked,addArtistPrefix:this.artistPrefixCheckbox.checked,insertBlankLines:this.insertBlankLinesCheckbox.checked}}setGenerationOptions(e){typeof e.outputCount=="number"&&(this.outputCountInput.value=e.outputCount.toString()),typeof e.escapeParentheses=="boolean"&&(this.escapeParenthesesCheckbox.checked=e.escapeParentheses),typeof e.replaceSpaces=="boolean"&&(this.replaceSpacesCheckbox.checked=e.replaceSpaces),typeof e.addArtistPrefix=="boolean"&&(this.artistPrefixCheckbox.checked=e.addArtistPrefix),typeof e.insertBlankLines=="boolean"&&(this.insertBlankLinesCheckbox.checked=e.insertBlankLines)}setResult(e){this.getGenerationOptions().insertBlankLines?this.resultTextarea.value=e.join(`

`):this.resultTextarea.value=e.join(`
`)}}function v(s,e){return e===1?s:`(${s}:${e.toFixed(1)})`}function S(s,e){let t=s;return e.addArtistPrefix&&(t=`artist:${t}`),e.replaceSpaces&&(t=t.replace(/\s+/g,"_")),e.escapeParentheses&&(t=t.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),t}function G(s,e){return Math.random()*(e-s)+s}function T(s,e){return Math.floor(Math.random()*(e-s+1))+s}function E(s,e){return[...s].sort(()=>.5-Math.random()).slice(0,e)}class L{static generateSinglePrompt(e,t){const r=[];for(const n of e){const a=this.parseTagsFromText(n.tags);if(a.length===0)continue;const o=T(n.minCount,n.maxCount);if(o===0)continue;const u=E(a,o);for(const p of u){const i=S(p.trim(),t),c=G(n.minWeight,n.maxWeight),l=v(i,c);r.push(l)}}return r.join(", ")}static generatePrompts(e,t){const r=[];for(let n=0;n<t.outputCount;n++){const a=this.generateSinglePrompt(e,t);r.push(a)}return r}static parseTagsFromText(e){return Array.isArray(e)?e:e.split(`
`).map(r=>r.trim()).filter(r=>r.length>0)}}const C="random-prompt-generator-state";function N(){try{const s=localStorage.getItem(C);return s?JSON.parse(s):null}catch(s){return console.warn("LocalStorageからの読み込みに失敗しました:",s),null}}function I(s){try{localStorage.setItem(C,JSON.stringify(s))}catch(e){console.warn("LocalStorageへの保存に失敗しました:",e)}}function P(){const s=(t=0)=>({tags:[],minCount:t,maxCount:3,minWeight:.5,maxWeight:1.3}),e={outputCount:5,escapeParentheses:!1,replaceSpaces:!1,addArtistPrefix:!1,insertBlankLines:!0};return{tagGroup1:s(1),tagGroup2:s(0),tagGroup3:s(0),generationOptions:e,generatedPrompts:[]}}class B{container;tagGroups=[];generationGroup;appState;constructor(e){this.container=e,this.appState=N()||P(),this.generationGroup=new k(()=>this.generatePrompts()),this.init()}init(){this.container.innerHTML="";const e=document.createElement("header");e.className="text-center mb-8",e.innerHTML=`
      <h1 class="text-4xl font-bold text-gray-800 mb-2">Random Prompt Generator</h1>
      <p class="text-gray-600">画像生成AI用プロンプトをランダム生成</p>
    `;const t=document.createElement("main");t.className="space-y-6";for(let n=1;n<=3;n++){const a=new y(n,()=>this.saveState());this.tagGroups.push(a),t.appendChild(a.getElement())}t.appendChild(this.generationGroup.getElement());const r=document.createElement("footer");r.className="text-center mt-12 pt-8 border-t border-gray-200",r.innerHTML=`
      <p class="text-gray-500 text-sm">
        設定は自動的にLocalStorageに保存されます
      </p>
    `,this.container.appendChild(e),this.container.appendChild(t),this.container.appendChild(r),this.loadState()}generatePrompts(){try{const e=[this.tagGroups[0].getTagGroupData(),this.tagGroups[1].getTagGroupData(),this.tagGroups[2].getTagGroupData()],t=this.generationGroup.getGenerationOptions(),r=L.generatePrompts(e,t);this.generationGroup.setResult(r),this.appState.generatedPrompts=r,this.saveState(),console.log("プロンプト生成完了:",r)}catch(e){console.error("プロンプト生成中にエラーが発生しました:",e),alert("プロンプト生成中にエラーが発生しました")}}saveState(){this.appState.tagGroup1=this.tagGroups[0].getTagGroupData(),this.appState.tagGroup2=this.tagGroups[1].getTagGroupData(),this.appState.tagGroup3=this.tagGroups[2].getTagGroupData(),this.appState.generationOptions=this.generationGroup.getGenerationOptions(),I(this.appState)}loadState(){this.tagGroups[0].setTagGroupData(this.appState.tagGroup1),this.tagGroups[1].setTagGroupData(this.appState.tagGroup2),this.tagGroups[2].setTagGroupData(this.appState.tagGroup3),this.generationGroup.setGenerationOptions(this.appState.generationOptions),this.appState.generatedPrompts.length>0&&this.generationGroup.setResult(this.appState.generatedPrompts)}}const x=document.createElement("div");x.className="min-h-screen bg-gray-100 p-4";x.innerHTML=`
  <div class="max-w-6xl mx-auto" id="app-content">
    <!-- アプリケーションのコンテンツがここに追加されます -->
  </div>
`;document.querySelector("#app").appendChild(x);const W=document.querySelector("#app-content");new B(W);console.log("Random Prompt Generator UI が起動しました");
